<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin - Palette & Pearls</title>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
</head>
<body>

<h2>Admin Panel</h2>

<input id="name" placeholder="Product name"><br><br>
<input id="price" placeholder="Price"><br><br>
<input type="file" id="image"><br><br>

<button onclick="uploadProduct()">Upload Product</button>

<p id="status"></p>

<script>

const firebaseConfig = {
apiKey: "AIzaSyAsolLIxR8TQCelRdOWX14XLh4Ydx2vuVo",
authDomain: "paletteandpearls-41013.firebaseapp.com",
projectId: "paletteandpearls-41013",
storageBucket: "paletteandpearls-41013.firebasestorage.app",
messagingSenderId: "783620692633",
appId: "1:783620692633:web:9d7d44fd19496757ea3608"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

function uploadProduct(){

document.getElementById("status").innerText="Uploading...";

let file=document.getElementById("image").files[0];

if(!file){
document.getElementById("status").innerText="Please select image";
return;
}

let formData=new FormData();
formData.append("file",file);
formData.append("upload_preset","palettepearls");

fetch("https://api.cloudinary.com/v1_1/dmpivocsn/image/upload",{
method:"POST",
body:formData
})
.then(response=>response.json())
.then(data=>{

if(data.secure_url){

db.collection("products").add({
name:document.getElementById("name").value,
price:document.getElementById("price").value,
image:data.secure_url
})
.then(()=>{
document.getElementById("status").innerText="Product added successfully";
})
.catch(error=>{
document.getElementById("status").innerText="Firebase error: "+error;
});

}else{
document.getElementById("status").innerText="Cloudinary upload failed";
}

})
.catch(error=>{
document.getElementById("status").innerText="Upload error: "+error;
});

}

</script>

</body>
</html>
